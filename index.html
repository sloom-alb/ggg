<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>موقع يجلب البيانات من Google Sheets مع قوائم منسدلة</title>
    <style>
        select {
            margin: 10px;
            padding: 5px;
        }
        table {
            margin-top: 20px;
            border-collapse: collapse;
        }
        td, th {
            border: 1px solid black;
            padding: 8px;
        }
    </style>
</head>
<body>
    <h1>بيانات من Google Sheets</h1>

    <!-- القوائم المنسدلة -->
    <label for="column1Filter">اختر من العمود الأول:</label>
    <select id="column1Filter">
        <option value="">-- اختر --</option>
    </select>

    <label for="column2Filter">اختر من العمود الثاني:</label>
    <select id="column2Filter">
        <option value="">-- اختر --</option>
    </select>

    <!-- المكان الذي ستعرض فيه البيانات -->
    <div id="data"></div>

    <script>
        const sheetID = '1sV8b2fPxyz1234567';  // ضع هنا الـ ID الخاص بالجدول
        const apiKey = 'YOUR_API_KEY';  // ضع هنا الـ API Key الخاص بك
        const range = 'Sheet1!A1:D100';  // تحديد النطاق الذي تريد جلبه

        const url = `https://sheets.googleapis.com/v4/spreadsheets/${sheetID}/values/${range}?key=${apiKey}`;
        
        let allData = [];

        // جلب البيانات من Google Sheets
        function fetchData() {
            fetch(url)
            .then(response => response.json())
            .then(data => {
                allData = data.values;  // تخزين البيانات للاستخدام لاحقًا
                populateFilters(allData);  // تحديث القوائم المنسدلة
                filterAndDisplayData();  // عرض البيانات بناءً على الفلاتر
            })
            .catch(error => {
                console.error('Error fetching data:', error);
            });
        }

        // استخراج القيم الفريدة وملء القوائم المنسدلة
        function populateFilters(data) {
            const column1Values = [...new Set(data.slice(1).map(row => row[0]))];  // استخراج القيم الفريدة من العمود الأول
            const column2Values = [...new Set(data.slice(1).map(row => row[1]))];  // استخراج القيم الفريدة من العمود الثاني

            const column1Filter = document.getElementById('column1Filter');
            const column2Filter = document.getElementById('column2Filter');

            // تفريغ القوائم الحالية
            column1Filter.innerHTML = '<option value="">-- اختر --</option>';
            column2Filter.innerHTML = '<option value="">-- اختر --</option>';

            // ملء القوائم بالقيم الفريدة
            column1Values.forEach(value => {
                let option = document.createElement('option');
                option.value = value;
                option.textContent = value;
                column1Filter.appendChild(option);
            });

            column2Values.forEach(value => {
                let option = document.createElement('option');
                option.value = value;
                option.textContent = value;
                column2Filter.appendChild(option);
            });
        }

        // عرض البيانات بناءً على الفلاتر المختارة
        function filterAndDisplayData() {
            const selectedColumn1 = document.getElementById('column1Filter').value;
            const selectedColumn2 = document.getElementById('column2Filter').value;

            let filteredData = allData.slice(1);  // حذف الصف الأول (العناوين)

            // فلترة البيانات بناءً على الفلاتر
            if (selectedColumn1) {
                filteredData = filteredData.filter(row => row[0] === selectedColumn1);
            }

            if (selectedColumn2) {
                filteredData = filteredData.filter(row => row[1] === selectedColumn2);
            }

            displayData(filteredData);
        }

        // عرض البيانات في الجدول
        function displayData(data) {
            let output = '<table><thead><tr>';
            output += '<th>العمود الأول</th><th>العمود الثاني</th><th>العمود الثالث</th><th>العمود الرابع</th>';
            output += '</tr></thead><tbody>';

            // عرض البيانات بناءً على التصفية
            data.forEach(row => {
                output += '<tr>';
                row.forEach(cell => {
                    output += `<td>${cell}</td>`;
                });
                output += '</tr>';
            });

            output += '</tbody></table>';
            document.getElementById('data').innerHTML = output;
        }

        // تحديث البيانات كل ثانية
        setInterval(fetchData, 1000);

        // ربط الفلاتر بتحديث العرض عند التغيير
        document.getElementById('column1Filter').addEventListener('change', filterAndDisplayData);
        document.getElementById('column2Filter').addEventListener('change', filterAndDisplayData);

        // جلب البيانات عند تحميل الصفحة
        fetchData();
    </script>
</body>
</html>
