function doGet(e) {
  // احصل على الورقة المطلوبة من جدول البيانات
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName('درجات الأسبوع (حفظ)'); // استبدل باسم الورقة الخاص بك
  
  // احصل على جميع البيانات الموجودة في الورقة
  var data = sheet.getDataRange().getValues();
  
  // تهيئة مصفوفة لتخزين البيانات
  var jsonData = [];
  
  // معالجة كل صف في الورقة وتحويله إلى JSON
  for (var i = 0; i < data.length; i++) {
    var row = {};
    
    // استخدم عدد الأعمدة الفعلي في الورقة
    for (var j = 0; j < Math.min(20, data[i].length); j++) {
      row['column' + (j + 1)] = data[i][j] || ''; // عرض القيمة من العمود، مع ضمان أنه لا توجد أخطاء في حالة وجود بيانات ناقصة
    }
    
    jsonData.push(row);
  }
  
  // إرجاع البيانات على هيئة JSON
  return ContentService.createTextOutput(JSON.stringify(jsonData)).setMimeType(ContentService.MimeType.JSON);
}
